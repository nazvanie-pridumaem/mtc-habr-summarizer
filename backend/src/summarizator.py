import re
from typing import Any, Dict, List

import torch
from bs4 import BeautifulSoup
from transformers import T5ForConditionalGeneration, T5Tokenizer

# Загрузка токенизатора и модели
model = T5ForConditionalGeneration.from_pretrained("denisnaenko/t5_habr_summarizer", trust_remote_code=False)
tokenizer = T5Tokenizer.from_pretrained("denisnaenko/t5_habr_summarizer", trust_remote_code=False)

# Определяем устройство (GPU если доступен)
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
model = model.to(device)
model.eval()  # Переводим в режим инференса

# Параметры батчинга
BATCH_SIZE = 8
MAX_INPUT_LENGTH = 512
MAX_OUTPUT_LENGTH = 350
MIN_OUTPUT_LENGTH = 150
CHUNK_SIZE = 450

def basic_clean(text):
    if not isinstance(text, str):
        return text
    text = re.sub(r'\n', ' ', text)
    text = re.sub(r'\s+', ' ', text)
    return text.strip()

def advanced_clean(text):
    if not isinstance(text, str):
        return ''
    
    text = basic_clean(text)
    text = re.sub(r'http\S+|www\S+|https\S+', '', text, flags=re.MULTILINE)
    text = re.sub(r'\S+@\S+', '', text)
    text = re.sub(r'<.*?>', '', text)
    text = re.sub(r'\s+([.,!?:;])', r'\1', text)
    text = re.sub(r'([.,!?:;])\s+', r'\1 ', text)
    
    return re.sub(r'\s+', ' ', text).strip()


def clean_text(text, advanced=False):
    if not isinstance(text, str):
        return text
    return advanced_clean(text) if advanced else basic_clean(text)


def split_text_into_chunks(text: str, chunk_size: int = CHUNK_SIZE) -> List[str]:
    """Разбивает текст на чанки с учетом границ предложений"""
    words = text.split()
    chunks = []
    current_chunk = []
    current_size = 0
    
    for word in words:
        current_chunk.append(word)
        current_size += 1
        
        # Проверяем, является ли слово концом предложения
        if current_size >= chunk_size and word.endswith(('.', '!', '?')):
            chunks.append(' '.join(current_chunk))
            current_chunk = []
            current_size = 0
    
    # Добавляем оставшийся текст
    if current_chunk:
        chunks.append(' '.join(current_chunk))
    
    return chunks


def batch_summarize(texts: List[str], model, tokenizer, batch_size: int = BATCH_SIZE) -> List[str]:
    """Батчевая суммаризация текстов"""
    summaries = []
    
    # Обрабатываем тексты батчами
    for i in range(0, len(texts), batch_size):
        batch_texts = texts[i:i + batch_size]
        
        # Добавляем префикс "summarize: " к каждому тексту
        batch_texts = ["summarize: " + text for text in batch_texts]
        
        # Токенизация батча
        inputs = tokenizer(
            batch_texts,
            return_tensors="pt",
            max_length=MAX_INPUT_LENGTH,
            truncation=True,
            padding=True
        ).to(device)
        
        # Генерация суммаризаций
        with torch.no_grad():
            outputs = model.generate(
                inputs["input_ids"],
                attention_mask=inputs["attention_mask"],
                max_length=MAX_OUTPUT_LENGTH,
                min_length=MIN_OUTPUT_LENGTH,
                num_beams=5,
                length_penalty=2.0,
                no_repeat_ngram_size=2,
                early_stopping=True
            )
        
        # Декодирование результатов
        batch_summaries = tokenizer.batch_decode(outputs, skip_special_tokens=True)
        summaries.extend(batch_summaries)
    
    return summaries


def summarize_long_text(text: str, model, tokenizer) -> str:
    """Суммаризация длинного текста с использованием чанков и батчинга"""
    # Если текст короткий, обрабатываем как обычно
    if len(text.split()) <= CHUNK_SIZE:
        return batch_summarize([text], model, tokenizer)[0]
    
    # Разбиваем на чанки
    chunks = split_text_into_chunks(text, CHUNK_SIZE)
    
    # Батчевая суммаризация чанков
    chunk_summaries = batch_summarize(chunks, model, tokenizer)
    
    # Объединяем суммаризации чанков
    combined_summary = " ".join(chunk_summaries)
    
    # Если объединенная суммаризация все еще слишком длинная, суммаризируем еще раз
    if len(combined_summary.split()) > CHUNK_SIZE:
        return summarize_long_text(combined_summary, model, tokenizer)
    
    return combined_summary


def parse_html_content(html_content: str):
    soup = BeautifulSoup(html_content, 'html.parser')
    result = []
    current_header = None
    current_content = []
    
    def process_element(element):
        nonlocal current_content
        
        if element.name in ['h1', 'h2', 'h3']:
            return element.get_text(strip=True)
        elif element.name == 'blockquote':
            parts = []
            current_part = []
            
            for child in element.children:
                if child.name == 'br':
                    if current_part:
                        parts.append(' '.join(current_part))
                        current_part = []
                else:
                    text = child.get_text(strip=True)
                    if text:
                        current_part.append(text)
            
            if current_part:
                parts.append(' '.join(current_part))
            
            if parts:
                current_content.append(parts)
        elif element.name == 'ul':
            list_items = [li.get_text(strip=True) for li in element.find_all('li', recursive=False)]
            if list_items:
                current_content.append(list_items)
        elif element.name is None or element.name not in ['br', 'b']:
            text = element.get_text(strip=True)
            if text:
                current_content.append(text)
    
    for element in soup.children:
        if element.name in ['h1', 'h2', 'h3']:
            if current_content:
                result.append({
                    'header': current_header,
                    'content': current_content.copy()
                })
                current_content = []
            
            current_header = element.get_text(strip=True)
        else:
            process_element(element)
    
    if current_content:
        result.append({
            'header': current_header,
            'content': current_content.copy()
        })
    
    return result


def summarize_structure_optimized(structure: List[Dict[str, Any]], model, tokenizer) -> List[Dict[str, Any]]:
    """Оптимизированная суммаризация структуры с батчингом"""
    
    def process_item(item):
        if isinstance(item, str):
            return item
        elif isinstance(item, list):
            processed_items = []
            for subitem in item:
                processed_items.append(process_item(subitem))
            return " ".join(processed_items)
        return str(item)
    
    def combine_content(section):
        text_parts = []
        for item in section['content']:
            text_parts.append(process_item(item))
        return " ".join(text_parts) if text_parts else ""
    
    # Собираем все тексты для суммаризации
    texts_to_summarize = []
    section_indices = []
    
    for idx, section in enumerate(structure):
        full_text = combine_content(section)
        if full_text:
            texts_to_summarize.append(full_text)
            section_indices.append(idx)
    
    # Обрабатываем длинные тексты
    processed_texts = []
    for text in texts_to_summarize:
        if len(text.split()) > CHUNK_SIZE:
            # Для очень длинных текстов используем чанкинг
            summary = summarize_long_text(text, model, tokenizer)
            processed_texts.append(summary)
        else:
            processed_texts.append(text)
    
    # Батчевая суммаризация всех текстов
    if processed_texts:
        summaries = batch_summarize(processed_texts, model, tokenizer)
        
        # Обновляем структуру
        for idx, section_idx in enumerate(section_indices):
            structure[section_idx]['content'] = [summaries[idx]]
    
    # Очищаем пустые секции
    for section in structure:
        if section not in [structure[i] for i in section_indices]:
            section['content'] = []
    
    return structure


def process_article(html_content: str, model=model, tokenizer=tokenizer) -> List[Dict[str, Any]]:
    """Главная функция для обработки статей"""
    # Базовая очистка с сохранением HTML
    cleaned_basic = clean_text(html_content)
    
    # Парсинг HTML
    parsed_content = parse_html_content(cleaned_basic)
    
    # Оптимизированная суммаризация с батчингом
    summarized = summarize_structure_optimized(parsed_content, model, tokenizer)
    
    return summarized

if __name__ == '__main__':
    sample = """
    <br/>\n<br/>\n2 июля 2016 г. не стало всемирно известного ученого, инженера и изобретателя Ру́дольфа Э́миля Ка́лмана. <br/>\nМногим он знаком прежде всего как создатель алгоритма оценивания, названного его именем. Однако вклад этого человека в науку намного значительнее. Р. Калман являлся одним из основателей современной теории управления. Его работы изменили способы обработки информации в широком классе приложений, начиная от навигации и заканчивая экономикой. Идеи Р. Калмана дали мощный толчок развитию техники и вдохновили тысячи исследователей и инженеров на новые изобретения. <br/>\n<br/>\nПредлагаю читателям вспомнить об этом замечательном человеке и познакомиться с историей создания алгоритма, известного как Фильтр Калмана.<br/>\n<br/>\nМатериал представляет собой статью проф. д.т.н. Степанова Олега Андреевича, посвященную 80-летнему юбилею Р. Калмана. Она была опубликована в журнале «Гироскопия и навигация» в 2010 г., однако, как я полагаю, осталась неизвестной широкому кругу пользователей сети.<br/>\n<br/>\n<h2>Фильтр Калмана. История и современность</h2><br/>\n<b class=\"spoiler_title\">Предисловие</b>Статья посвящена 80-летию одного из основателей современной теории управления Р.Э. Калмана. Кратко излагаются предпосылки получения наиболее важного его результата, связанного с созданием рекуррентной оптимальной процедуры оценивания, анализируются некоторые тенденции развития прикладных методов решения задач фильтрации. Приводятся основные биографические данные о Р. Калмане и обсуждаются его творческие связи с российскими учеными.<br/>\n<br/>\n<br/>\n<h3>Введение</h3><br/>\nВ этом году отмечается восьмидесятилетний юбилей одного из основателей современной теории управления Р. Калмана. Его вклад в теорию управления широко известен и описан в многочисленных публикациях и изданиях. Так, еще, когда отмечался шестидесятилетний юбилей Калмана в 1990 г., был выпущен специальный сборник «Математическая теория систем. Влияние Р. Калмана» [1]. В него вошли работы ведущих ученых, описывающих вклад Р. Калмана в различные области теории фильтрации и управления. В 2001 г. под общей редакцией Т. Базара вышло специальное издание «Двадцать пять основополагающих статей в управлении (1932-1982)» [2]. Этот объемный труд был подготовлен по инициативе «Общества по управлению» Института инженеров по электротехники и электронике (IEEE) в целях определения наиболее значимых результатов, полученных в весьма важный период развития теории управления. В редакционную комиссию этого сборника вошли более десятка крупнейших ученых из разных стран, в частности такие как: П. Кокотович, Л. Льюнг, Б. Андерсон, Х. Квакернак, А. Исидори, К. Острем. В сборник были включены статьи Х. Найквиста, Н.Винера, Л.С.Понтрягина, В.А. Якубовича и ряда других известных ученых. Причем Р. Калман оказался единственным, у кого для этого издания было отобрано три статьи, при этом две из них были написаны в возрасте 30 лет [3-5].<br/>\n<br/>\nР. Калман неоднократно бывал в России, знаком со многими нашими известными учеными. Здесь высоко оценивают его достижения. Наиболее важные статьи и книги Калмана оперативно переводились на русский язык и хорошо известны специалистам [6-10]. В связи с 80-летием Р. Калмана в апреле этого года в Институте проблем управления Российской академии наук при активном участии и поддержке международной общественной организации «Академия навигации и управление движением (АНУД)» был проведен специальный семинар, посвященный юбиляру [12, 13]. На очередном общем собрании АНУД 2 июня 2010 г. автором этой заметки был представлен доклад, также посвященный юбилею известного ученого. В докладе было затронуты два вопроса. Один из них касался некоторых предпосылок и последствий получения одного из наиболее важных результатов Р. Калмана, связанного с созданием рекуррентной оптимальной процедуры оценивания, получившей впоследствии наименование – фильтр Калмана. Второй – творческие связи Р. Калмана с учеными нашей страны. Настоящая статья подготовлена по материалам доклада на общем собрании АНУД.<br/>\n<br/>\n<h3>О Калмане</h3><br/>\nКоротко основные биографические данные [1, 14-16]. Рудольф Калман родился 19 мая 1930 года в г. Будапеште. Во время войны в 1943 г. вместе с родителями через Турцию эмигрировал в США. Получил степень бакалавра и магистра соответственно в 1953 и 1954 гг. в Массачусетском технологическом институте (MIT). Докторскую степень защитил под руководством Дж. Рагаззини (J.R. Ra-gazzini) в 1957 г. в Колумбийском университете. С 1957 по 1958 г. работает штатным инженером в исследовательской лаборатории известной фирмы IBM, а с 1958 г. — в Исследовательском институте перспективных разработок (Research Institute for Advance Study-RIAS) в Балтиморе, возглавляемом Соломоном Левшецем (1884-1972) – американским математиком российского происхождения, которого Калман считал одним из своих наставников. Здесь Р. Калман прошел путь от математика-исследователя до заместителя директора по научной работе. Именно в этот период (1958-1964) им были выполнены фундаментальные работы в области системного анализа и теории управления. В 1964 г. он переходит в Стэнфордский университет на отделение «Электротехника, механика и исследование операций». В 1971 становится директором Математического центра системного анализа и профессором университета Флориды. С 1973 г. Р. Калман работает в Швейцарском федеральном институте технологий в Цюрихе.<br/>\n Р. Калман – лауреат многих престижных премий и наград, таких как: IEEE Medal of Honor (1974), IEEE Centennial Medal (1984 г.), премия Kyoto Prize (1985) (японский аналог Нобелевской премии в области новых технологий), Steel Prize (Премия Беллмана, 1997). Среди последних наград, конечно же, следует упомянуть о присужденной в январе 2008 г. Инженерной национальной Академией США премии и памятной медали им. Чарльза Старка Дрейпера за разработку и внедрение «оптимальной дискретной техники (известной как фильтр Калмана), широко используемой при решении различного рода прикладных задач». Памятная медаль и премия в размере $500000 были вручены в Вашингтоне 19 февраля 2008 г. И, наконец, самая последняя значимая награда – это ежегодная Национальная медаль США в области науки, которая была присуждена в 2008 г. и вручена Р. Калману 7 октября 2009 г. в Белом доме президентом США Бараком Обамой.<br/>\n<br/>\nР. Калман является иностранным членом Американской, Венгерской и Французской академий, а с 1994 – иностранный член Российской академии наук (РАН) по отделению проблем машиностроения, механики и процессов управления.<br/>\n<br/>\n<h3>Предыстория</h3><br/>\nГоворя о предыстории создания фильтра Калмана (ФК), можно привести слова самого Калмана: «Мне повезло так же, как Ньютону, которому посчастливилось родиться ко времени, когда законы Кеплера были готовы и ждали его» [10]. Существуют достаточно обширная литература, в которой обсуждаются исторические аспекты развития и становления теории фильтрации [14, 17-26]. Среди зарубежных работ, несомненно, следует выделить обзор крупнейшего известного ученого в области фильтрации Т. Кайлатца [19]. Он включает 390 наименований, причем в отличие от многих работ, издаваемых за рубежом. Обзор достаточно объективно отражает вклад в теорию фильтрации не только зарубежных, но и отечественных ученых.<br/>\n<br/>\nКратко отразим те основные вехи, которые непосредственно связаны с появлением первой работы Калмана, посвященной его знаменитому фильтру [3].<br/>\n<br/>\nВ качестве предшественников Калмана в разработке теории оценивания в первую очередь вспоминают создателей метода наименьших квадратов (МНК): немецкого математика, астронома, геодезиста и физика Карла Фридриха Гаусса (1777-1855) и французского математика Адриена Мари Лежандра (1752-1833).<br/>\n<br/>\nГауссу было 18 лет (1795), когда он впервые использовал, но не опубликовал метод наименьших квадратов. Лежандр независимо изобрел аналогичный метод и в 1806 г. опубликовал полученные им результаты [17-19]. Чтобы понять сложность взаимоотношений между двумя великими учеными в части отстаивания пальмы первенства в изобретении МНК, приведем несколько цитат из статьи [17], которую в переводе также можно найти в работе [27]. В книге «Теория движения небесных тел» 1809 г. К.Ф. Гаусс отмечал следующее: «Наш принцип, которым мы пользуемся с 1795 г., недавно был опубликован Лежандром в его работе Nouvelles methodes pour la determination des orbites des cometes, Paris, 1806, в ней объяснены некоторые другие его свойства, которые для краткости мы опускаем». Это, естественно, не могло понравиться Лежандру, который писал: «Гаусс, будучи уже достаточно богат открытиями, мог бы поиметь приличие не присваивать себе МНК». Гаусс чувствовал себя затемненным тенью Лежандра и сетовал по этому поводу: «Мне кажется, это злой рок — пересекаться практически во всех теоретических вопросах с Лежандром. Так было в высшей арифметике,.., и сейчас опять МНК, который также используется в трудах Лежандра и действительно красиво изложен». С тех пор, как отмечается в [17], историки нашли достаточно оснований для доказательства приоритета Гаусса в части изобретения МНК, и скорее Лежандр оказался в тени Гаусса.<br/>\n<br/>\nЛюбопытно обратить внимание на тот факт, что первоначально Гаусс рассматривал проблему оценивания с вероятностной точки зрения. Он полагал, что ошибки независимы и совместная функция распределения вероятности остатков измерений равна произведению соответствующих функций каждого из остатков, закон распределения которых в свою очередь полагался нормальным. Хотя Гаусс и понимал в какой-то степени ущербность этого закона, предполагающего возможность появления бесконечно больших по уровню ошибок измерения, данная им вероятностная трактовка МНК в значительной степени заложила основы для появления и обоснования метода максимума функции правдоподобии, предложенного впоследствии Р.А.Фишером (1912). Важно подчеркнуть, что в дальнейшем сам Гаусс отдавал предпочтение обоснованию МНК с детерминированных позиций – минимизации некоторой функции разности между оценкой и наблюдениями [17].<br/>\n<br/>\nГоворя о предшественниках Р. Калмана, необходимо вспомнить еще двух ученых: Андрея Николаевича Колмогорова (1903-1986), выдающегося советского математика, основоположника современной теории вероятностей, и крупнейшего американского математика Норберта Винера (1894-1964), чье имя обычно связывают с зарождением той науки, которая называется кибернетикой.<br/>\n<br/>\nЕсли Гаусс и Лежандр вначале 18-го века рассматривали задачу оценивания неизменного во времени вектора, то Колмогоров и Винер решали уже задачу оценивания изменяющихся параметров. При этом Колмогоров занимался задачей оценивания стационарной гауссовской случайной последовательности по ее измерениям на фоне ошибок измерения, которые также предполагались значениями гауссовской стационарной последовательности. Считая, что известны корреляционные функции для оцениваемой последовательности и ошибок измерения, Колмогоров, не обсуждая сам алгоритм оценивания, получил выражения для дисперсий ошибок оптимальных в среднеквадратическом смысле оценок. Сначала он опубликовал эти результаты без доказательства в 1939 г. [28], а потом привел уже более подробные результаты в 1941 г. [29]. Работы Винера в этой области проводились в рамках военного заказа и в открытой печати были представлены в виде книги лишь в 1949 г. [30]. Винер рассматривал задачу для непрерывного времени и им был получен алгоритм нахождения оценки в виде свертки реализации измерений с весовой функцией, которая в свою очередь удовлетворяла интегральному уравнению Винера – Хопфа. Задача первоначально рассматривалась для установившегося режима на бесконечном времени, и решение для нее было получено на основе факторизации спектральных плотностей. Заметим, что третья глава из этой книги под названием «The linear filter for a single time series» также впоследствии была отобрана, как статья в сборник [2].<br/>\n<br/>\nЧто же не устраивало Р. Калмана в постановке задаче и полученном ранее решении? Он был не вполне согласен с предположением о том, что статистические характеристики, подобные корреляционной функции, являются верным способом описания неопределенностей, а также с тем, что описание системы с помощью передаточной функции есть в точности то же самое, что и представление самой системы [10]. Кроме того, предложенные алгоритмы были не вполне удобны при решении прикладных задач, в том числе с использованием получающих широкое применение вычислительных машин. Существенным ограничением являлось используемое предположение о стационарном характере процессов и то, что решение было получено для бесконечного интервала времени.<br/>\n<br/>\nР. Калман, еще будучи студентом, и впоследствии, в течение приблизительно 10 лет упорно работал в направлении выявления связей между передаточными функциями и линейными дифференциальными уравнениями. К началу 60-х годов это выразилось в следующем обобщении: «Линейные системы, описанные матрицей передаточных функций, тождественны полностью наблюдаемым и управляемым линейным векторным дифференциальным уравнениям» [10].<br/>\n<br/>\n<h3>Фильтр Калмана. Первая публикация</h3><br/>\nК концу 50-х годов у Р. Калмана уже был ряд результатов по использованию описания систем в пространстве состояний при рассмотрении задач теории управления. Мысль о возможности применения подхода, основанного на описании систем в пространстве состояний, для решения задачи винеровской фильтрации, пришла к нему в конце ноября 1958 г. поздним вечером, по возвращении поездом из Принстона в Балтимор, когда по какой-то причине поезд простоял на полустанке в течение часа [14].<br/>\n<br/>\nПервый публичный доклад с изложением идеи решения задачи винеровской фильтрации с помощью алгоритма, получившего впоследствии название фильтра Калмана, состоялся 1 апреля 1959 г. в Кливленде [10], а первая работа «A new approach to linear filtering and prediction problems» была опубликована в 1960 г. в Transactions of the ASME (American Society of Mechanical Engineers – Американское общество инженеров механиков) [3]. <br/>\n <br/>\nСледует заметить, что статья появилась не в традиционном для рассматриваемой в ней задачи журнале, издаваемом Американским обществом инженеров-электриков, а в журнале Общества инженеров-механиков. Дело в том, что в то время сообщество инженеров-электриков достаточно скептически воспринимало изложенные в ней идеи, и вопрос о публикации мог значительно затянуться. Этим, кстати сказать, объясняется и содержание одной из сносок, сделанных редакцией. В ней отмечалось, что результаты и выводы, полученные в публикуемой работе, являются личным результатом автора и ASME ответственность за них не несет. А это была именно та работа, в которой впервые предложен алгоритм решения задачи оценивания с использованием пространства состояния. Особенность первой работы заключалось, в частности, в том, что рассматривалась задача оценивания одной последовательности на фоне другой при отсутствии составляющей ошибки в виде белого шума. По сути, это была та задача, которая решалась Колмогоровым и Винером. При доказательстве полученных результатов была использована известная в основном лишь математикам теорема об ортогональной проекции. И хотя в статье традиционно предполагался гауссовский характер оцениваемых последовательностей, из представленных в ней результатов вытекало, что предложенный алгоритм, оптимальный при гауссовском характере ошибок измерения и возмущающих шумов, сохраняет свою оптимальность и при произвольном их распределении в классе линейных систем. Об этом, весьма важном свойстве нередко забывают, в то время как именно оно и определяет эффективность применения фильтра Калмана при решении прикладных задач. В этой же статье была также доказана теорема дуальности или двойственности, устанавливающая связь задач фильтрации и управления.<br/>\n<br/>\nПо мнению Калмана [10] <blockquote>«…фильтр Калмана был истинным открытием, так как:<br/>\n– Никто не представлял, что результат будет так прост?!<br/>\n– Никто не ожидал, что результат будет таким общим.<br/>\n– Никто не думал, что фильтр будет таким полезным»</blockquote><br/>\nИ еще одна цитата из этой же работы <blockquote>Конечно, я хорошо осознавал важность своего открытия и даже пробовал его объяснить своим подругам. Но, честно говоря, совершенно не представлял, что оно окажется таким важным и нужным [10]</blockquote><br/>\nПрежде чем коротко обсудить последствия появления первой работы, обсудим еще одну сноску, которая была сделана уже самим Р. Калманом и относилась к той части статьи, где говорилось о линейном характере используемых алгоритмов. По этому поводу Р. Калман писал: «Конечно, в общем случае эти задачи могут быть решены с помощью нелинейных фильтров. Однако к настоящему времени немного или почти ничего не известно о том, как получить (теоретически и практически) эти нелинейные фильтры» [3]. В связи с этим, конечно, следует вспомнить Руслана Леонтьевича Стратоновича (1930-1997), который в сущности к этому времени уже решил проблему оптимальной нелинейной фильтрации, базируясь на созданной им теорию условных марковских процессов.<br/>\n<br/>\nР.Л. Стратонович родился 31 мая 1930 г. в Москве, и ему так же, как и Калману в мае исполнилось бы 80 лет. Он экстерном закончил школу и получил золотую медаль. В 1947 г. поступил на физический факультет Московского государственного университета, на котором и проработал впоследствии профессором всю свою жизнь [31, 32].<br/>\n<br/>\nСтратонович создал стохастическое исчисление, которое является альтернативой к теории интеграла Ито и удобно для применения при описании физических проблем, ввел стохастический интеграл Стратоновича. В части решения задач фильтрации он получил уравнения в частных производных для апостериорной плотности, которая и необходима для вычисления оптимальной оценки. В дискретном случае их аналогом являются рекуррентные соотношения для этой плотности [33]. Линейный фильтр Калмана представляет собой частный случай, соответствующий линейной гауссовской задаче. К сожалению, вклад Р.Стратоновича в теорию фильтрации не оценен должным образом, несмотря на полученные им не менее значимые, чем Р.Калманом и Н.Винером, выдающиеся результаты в этой области [34-36]. Можно также с сожалением констатировать, что работы Р.Стратоновича, пожалуй, чаще цитируются в зарубежных публикациях, чем в работах российских авторов.<br/>\n<br/>\n<h3>Развитие прикладных алгоритмов фильтрации</h3><br/>\nПосле опубликования первой статьи Р. Калмана, посвященной решению задачи фильтрации на основе пространства состояний, это направление получило бурное развитие. Р. Калман нашел благодатную почву для применения своего алгоритма в Научно-исследовательском центре Эймса (Ames Research Center), входящего в состав НАСА, а также в лаборатории Ч. Дрейпера в MИТ [14, 20, 21]. Во время своего визита осенью 1960 г. он встретился с сотрудником центра в Эймсе С. Ф. Шмидтом, который сразу же оценил потенциальные возможности нового метода применительно к проекту «Аполло», связанному с полетом на Луну. Считается, что С.Ф. Шмидт был первым, кто использовал ФК при решении практических задач. В середине 60-х благодаря усилиям С.Ф. Шмидта ФК стал частью навигационной системы для транспортного самолета С5А. ФК использовался здесь в задаче комплексной обработки данных от инерциальной системы и радиолокатора, дополнительно решая также задачу отбраковки измерений с большими ошибками [14].<br/>\n<br/>\nР. Бьюси, который также работал в то время в RIAS, предложил Калману установить связь уравнения Винера-Хопфа с уравнением Риккати в ФК для непрерывного времени. Это и было сделано в их совместной работе [7]. В частности, было показано, что уравнение Риккати может иметь устойчивое решение, даже если исходная система неустойчива, при условии, что она управляема и наблюдаема. Кстати, как отмечается в [14], работа, посвященная фильтру Калмана — Бьюси для непрерывного времени, была первоначально отклонена по причине якобы имеющейся, но потом не подтвердившейся ошибки в доказательстве, найденной одним из рецензентов.<br/>\n<br/>\nПри использовании ФК при решении прикладных задач сразу же возникло множество проблем, связанных с выбором моделей, адекватно описывающих поведение ошибок измерительных систем; с чувствительностью алгоритмов к выбираемым моделям; со снижением объема вычислений при разработке субоптимальных алгоритмов фильтрации за счет сокращения размерности самого оцениваемого вектора состояния, упрощенного описания моделей ошибок измерений и порождающих шумов; с вычислительной устойчивостью предлагаемых процедур и т.д. Развитию идей Калмана и решению этих проблем были посвящены многочисленные публикации. Значительное внимание уделялось различным модификациям фильтров Калмана, адаптивным алгоритмам, решению нелинейных задач [1, 17-26, 37-39]. Стал широко применяться обобщенный ФК, который в ранних публикациях назывался фильтром Калмана — Шмидта [20]. Затем были предложены так называемые итерационные фильтры и фильтры более высокого порядка, которые представляли собой различные модификации алгоритмов калмановского типа [14, 37, 38]. Для решения нелинейных задач с существенными нелинейностями активно разрабатывались алгоритмы, основанные на использовании рекуррентных соотношений для апостериорной плотности. Здесь получили развитие такие алгоритмы как метод точечных масс, метод, основанный на полигауссовской аппроксимации апостериорной плотности, метод разделения, метод Монте-Карло и ряд других [18, 40-44].<br/>\n<br/>\nДо середины семидесятых годов теория фильтрации и ее приложения бурно развивались. В развитие теоретических основ фильтрации помимо Р.Л. Стратоновича значительный вклад также внесли российские ученые — Р.Ш.Липцер, А.Н.Ширяев, В.С.Пугачев, В.И.Тихонов, Н.К.Кульман, В.Н.Фомин, А.Б.Куржанский, М.С. Ярлыков и ряд других [12, 33, 45-48].<br/>\n<br/>\nВ целом можно указать два основных направления, в которых алгоритмы фильтрации получили наибольшее применение. Одно из них связано с разработкой радиотехнических, в том числе и радионавигационных, систем. Особенность этого направления заключалась в том, что рассматривались в основном задачи для непрерывного времени. В СССР и в дальнейшем в России значительный вклад в разработку алгоритмов решения задач фильтрации, помимо уже упомянутых, внесли также Ю.Г.Сосулин, М.А.Миронов, В.Н.Харисов, А.И.Перов, Б.И.Шахтарин, А.К. Розов и др.[24-27, 33, 49].<br/>\n<br/>\nДругое направление связано с навигацией, наведением и траекторным слежением. Здесь наряду с задачами в непрерывном времени почти сразу стали рассматриваться их дискретные варианты. Заметим, что в сборнике, посвященном 60-летию Калмана [1], именно навигационные задачи рассматривались в разделе, касающемся приложений [50]. Кстати сказать, при подготовке этого раздела активное участие принимал представитель французской фирмы Sagem – известный специалист в области интегрированных навигационных систем — Л. Камберлен (L. Cambeirlen) – активный член АНУД. В нашей стране это направление активно развивали А.А.Красовский, И.А.Богуславский, И.Н.Белоглазов, С.С.Ривкин, И.Б.Челпанов, Н.Т.Кузовков, О.С. Салычев, С.П.Дмитриев, Р.И.Ивановский [52-58] и многие другие. Более подробную информацию можно найти в библиографиях цитируемой литературы, а также в работе [59]. К сожалению, применительно к этому направлению пока не подготовлен какой-либо обстоятельный обзор, отражающий развитие прикладной теории фильтрации в этой области, так как это сделано в работах В.И. Тихонова [24-26], поэтому автор заранее извиняется за неполноту приводимого здесь списка, что в первую очередь обусловлено ограниченными рамками настоящей публикации.<br/>\n<br/>\nК началу 80-х годов появился некий спад интереса к разработке алгоритмов фильтрации. Дальнейший толчок в их развитии наблюдается уже в 90-е годы. В частности, это связано с потребностями в решении более сложных задач навигации применительно к подвижным объектам нетрадиционного типа, включая роботы, автомобили, различного рода автономные подвижные объекты, а также с существенным прогрессом в развитии вычислительных средств.<br/>\n<br/>\nВ настоящее время в разработках новых алгоритмов фильтрации можно выделить два основных направления [60].<br/>\n<br/>\nОдно из них связано с алгоритмами калмановской структуры, таких как регрессионные фильтры, сигма-поинт фильтры, так называемые UKF-фильтры (Unscented Kalman Filter) [61-64]. Все они основаны на достаточно простой идее замены процедуры вычисления производных при получении линейного представления на процедуры, близкие к процедуре статистической линеаризации. Идеологически эти алгоритмы вытекают из задачи построения линейных оптимальных алгоритмов для нелинейных, негауссовских систем [59]. Заметим, что решение задачи получения линейного оптимального алгоритма в линейной задаче для негауссовского случая сводится в обычному фильтру Калмана и в сущности об этом и говорится в работе [3]. Но в нелинейной задаче при реализации такого типа алгоритмов требуется численное нахождения интегралов, определяющих вторые моменты для измерений и взаимные моменты для измерений и оцениваемой последовательности [59]. При оценивании случайных процессов рекуррентно такую процедуру можно получить только путем замены описания апостериорной плотности на каждом шаге с помощью двух моментов, т.е. на основе гауссовской аппроксимации апостериорной плотности. Различные модификации сводятся к различным способам упрощения вычисления интегралов, которые требуется отыскивать при нахождении линейного представления. Справедливости ради необходимо заметить, что процедура статистической линеаризации предлагалась и ранее, в частности, она описана в книге [38], в которой цитируются первые работы, связанные с разработкой такого приема. Однако в то время не учитывался факт наличия дополнительной ошибки при замене нелинейной функции ее линейным аналогом.<br/>\n<br/>\nДругое направление также связано с разработкой алгоритмов нелинейной фильтрации. Задача вычисления оценки и соответствующей ей матрицы ковариаций для дискретного времени – это, в сущности, задача вычисления многократных интегралов при использовании рекуррентного соотношения для апостериорной плотности [43, 44]. В этой связи мощное развитие получили алгоритмы, основанные на последовательных методах Монте-Карло (Sequential Monte-Carlo) [65, 66]. Следует заметить, что первые основополагающие работы в этом направлении были опубликованы еще в середине восьмидесятых годов, в том числе и в CCCР. В частности, следует упомянуть нередко цитируемую публикацию В.С.Зарицкого, В.Б.Светника, Л.И.Шимелевича [67], связанную с методами Монте-Карло. К сожалению, в настоящее время в России эти исследования практически не проводятся, а за рубежом развитие современных методов нелинейной фильтрации на практике прогрессирует благодаря именно методам Монте-Карло [65, 66].<br/>\n<br/>\nЗавершая обсуждение вопросов, связанных с приложениями теории фильтрации, хотелось бы сделать еще одно замечание. В инженерной среде до сих пор продолжаются дискуссии о соотношении винеровских и калмановских алгоритмов фильтрации. Приверженцы частотных методов, которые активно используются при решении задачи винеровской фильтрации, доказывают преимущества этих алгоритмов, в то время как сторонники использования аппарата пространства состояний отстаивают достоинства фильтра Калмана. Сопоставление двух вариантов решения задач фильтрации в теоретическом плане можно найти, например, в работе [23]. Здесь уместно отметить следующие важные и общепризнанные моменты.<br/>\n<br/>\nНеоспоримое преимущество фильтра Калмана заключается в возможности решения задач нестационарной фильтрации марковских процессов на конечном времени.<br/>\n<br/>\nДля стационарных задач фильтрации в установившемся режиме оба подхода обеспечивают одинаковое решение. Вопрос использования того или иного подхода в таких задачах скорее вкусовой и является в значительной степени следствием той школы, к которой принадлежит разработчик.<br/>\n<br/>\nВместе с тем следует также учитывать, что при использовании частотного винеровского подхода имеется возможность решения задач стационарной фильтрации не только для марковских процессов.<br/>\n<br/>\nВ случае, когда на практике приходится иметь дело со стационарными задачами, несомненное преимущество частотного подхода заключается в его наглядности и возможности в некоторых ситуациях «на пальцах» проиграть различные варианты и комбинации, не будучи заложником результатов, выдаваемых компьютером. Заметим, что развитие алгоритмов фильтрации, предназначенных для решения стационарных задач, продолжается и в настоящее время, в том числе и в плане использования отличного от среднекваратичного критерия качества [12].<br/>\n<br/>\nРазработчики конкретных систем хорошо понимают, как непросто перейти от красивых формульных зависимостей, кем бы они ни были предложены, к работающему алгоритму. Это, кстати сказать, касается любых сколько-нибудь сложных алгоритмов. Успех внедрения алгоритмов того или иного типа, конечно, в первую очередь зависит от того, насколько используемый подход соответствует решаемой задаче. Вместе с тем в значительной степени возможность реализации алгоритма зависит и от настойчивости и грамотности самих разработчиков. Можно с уверенностью констатировать, что инженеры и разработчики, одинаково хорошо понимающие специфику работы как калмановских, так и винеровских алгоритмов, обладают значительными преимуществами перед специалистами, владеющими каким-либо одним подходом. И здесь следует вспомнить, к сожалению, безвременно ушедшего от нас талантливого ученого Леонида Петровича Несенюка, понимавшего все тонкости двух подходов, которому удалось получить ряд результатов, позволяющих лучше понять взаимосвязь двух подходов, их достоинства и недостатки [68].<br/>\n<br/>\n<h3>‘Darker side’</h3><br/>\nНазвание этого небольшого раздела можно перевести как – более темная сторона, и оно заимствовано из названия одной из частей доклада самого Калмана [10]. Речь здесь идет, в сущности, об эволюции его взглядов. Начиная с семидесятых годов, Калман стал критически оценивать обоснованность использования стохастического способа описания сигналов при решении прикладных задач. В частности, в докладе, сделанном им в 1984 г. на конференции, посвященной 50-летию института математики им В.А. Стеклова в Москве, во введении говорится: «…Побудительной причиной как для этого доклада, так и для моих размышлений последних лет, явилась одна мысль академика Л. С. Понтрягина, высказанная им в октябре 1969 г. во время посещения Стэнфорда. Я настолько хорошо помню это событие, что могу процитировать ее дословно: «Математики не верят в вероятность» [9]. В заключении доклада он пишет: «Наименьшие квадраты необходимо рассматривать как основной математический инструмент, а не теорию идентификации в условиях шумов. Я весьма счастлив разделить точку зрения Понтрягина и заниматься математикой, не связывая себя верой (т. е. априорной гипотезой), касающейся вероятности… По мнению Эйнштейна: «Бог не играет в кости». Подобно фразам дельфийского оракула она допускает различные толкования. На мой взгляд, ее смысл состоит в том, что …Природа не подчиняется правилам традиционной вероятности. Но Эйншнтейн не говорил, что Природа исключает неопределенность».<br/>\n<br/>\nВ более поздней работе Калман также отмечает: «…Случайный процесс представляет собой абстрактную придуманную конструкцию, но не такую, которая может быть воссоздана с помощью измерений. Процедуры для определения параметров случайного процесс являются косвенными. Если случайный процесс существует в аксиоматическом смысле, используемом в работе [3] (первая работа о фильтре Калмана (ФК)), а есть и такие люди, включая настоящего автора, которые утверждают обратное, то с фильтром Калмана все будет хорошо, т.к. все это математика. В противном случае вопрос может остаться открытым. Ответственность ложится на тех, кто хочет применить фильтр Калмана любой ценой…» [10].<br/>\n<br/>\nПолностью разделяя мысль об ответственности тех, кто хочет применить фильтр Калмана любой ценой, следует констатировать, что есть некоторое противоречие между реально существующими и отмеченными Калманом недостатками вероятностного подхода, с одной стороны, и эффективно работающими в различных приложениях алгоритмами, полученными на основе именно такого подхода.<br/>\n<br/>\n<h3>Связь с нашей страной</h3><br/>\nР. Калман знаком с ведущими отечественными учеными, он неоднократно бывал в СССР, а затем и в России — в 1960 (Москва [6]), 1968 (Ереван [69]), 1969 (Тбилиси, Киев [70]), 1970 (Санкт-Петербург), 1984 (Москва [9]), 2006 (Москва, Санкт-Петербург [16, 71]).<br/>\n<br/>\nС многими учеными в нашей стране Калман познакомился во время своего первого пребывания в 1960 г. на Всемирном конгрессе международной федерации по автоматическому управлению (ИФАК), о котором более подробно чуть ниже. Именно здесь Р. Калман познакомился с Р. Стратоновичем и впоследствии они имели достаточно длительную переписку [31].<br/>\n<br/>\nВ этом же году он впервые встретился с выдающимся советским математиком Л.С.Понтрягиным (1908-1988). Более близкое их знакомство состоялось впоследствии в 1969 г. в Тбилиси и затем по инициативе Р. Калмана Л.С. Потрягин был приглашен в США [72].<br/>\n<br/>\nКалман также много раз встречался с Я.З. Цыпкиным (1919-1997) [73], начиная с их знакомства в 1956 г. в Гельденберге, затем в 1960 г. в Москве и много раз на различных научных конференциях. Именно Я.З. Цыпкин редактировал книгу «Очерки по математической теории систем» при ее переводе на русский язык [8].<br/>\n<br/>\nР. Калман вел переписку с А.И.Лурье (1901-1980), что следует из библиографии к работе [5]. Он был хорошо знаком с В.С. Пугачевым (1911-1998) [15, 46]. Кстати сказать, в статье Калмана [3] имеются три ссылки на работы советских ученых: две — на Пугачева В.С. и одна — на В.В. Солодовникова (1910-1992).<br/>\n<br/>\nВ настоящее время Р. Калман нередко общается с председателем национального комитета по автоматическому управлению А.Б.Куржанским, имеющим значительные достижения в области теории фильтрации [48].<br/>\n<br/>\nР. Калман также хорошо знаком с профессором Санкт-Петербургского университета В.А. Якубовичем. Специалистам хорошо известна лемма Калмана — Якубовича — Попова, устанавливающая связь между частотными методами в теории управления и методами функций Ляпунова и опубликованная в 1962 г. [74]. В англоязычной литературе ее часто также называют леммой KJP (Kalman. Jukubovicn. Popov). Эта работа, кстати, небольшая по объему — всего 4 странички — также попала в специальный том 25 лучших публикаций в теории управления и послужила началом дальнейших значительных исследований в этой области [75]. Р. Калман получил близкие результаты годом позже, используя для доказательства понятия управляемости и наблюдаемости [76]. Бывая в нашем городе, Р. Калман всегда находит время для встречи с В.А. Якубовичем.<br/>\n<br/>\nНа вопрос о том, какое событие или приезд в нашу страну более всего ему запомнился, Р.Калман ответил, что, конечно же, это первое посещение, связанное с участием в Первом конгрессе международной федерации по автоматическому управлению (ИФАК) [77]. Это действительно было выдающимся событием для науки того времени. Конгресс проходил в Москве с 27 июня по 7 июля 1960 г. Сюда собрались 1190 участников и более 1000 приглашенных из 29 стран. Было отобрано 285 из 410 представленных докладов. Любопытные воспоминания об этом конгрессе не так давно опубликовал Б. Уидроу [78], известный ученый, основоположник теории построения адаптивных фильтров [79]. О значимости конгресса для нашей страны можно судить, в частности, и по тому факту, что на конгрессе с приветственным словом выступил заместитель председателя правительства, которым в то время был А.Н. Косыгин [77, т.1].<br/>\n<br/>\nПричины, по которым конгресс проводился именно в Москве, становятся ясными, если вспомнить о достижениях СССР в то время в одной лишь области – космонавтике. Так, 4 октября 1957 г. — запуск первого искусственного спутника Земли. 2 января 1960 г. — первый полет к Луне; 14 сентября 1960 г. — первая посадка космического аппарата «Луна-2» на поверхность Луны; 7 октября 1960 г. — первый облет Луны космическим аппаратом «Луна-3» и первые съемки еѐ с обратной стороны. И, наконец, 12 апреля 1961 г. — первый полет человека в Космос. Ясно, что развитие космонавтики требовало решения серьезных задач, связанных с управлением и обработкой сигналов, и значительные успехи отечественных ученых были в этой области общепризнанными.<br/>\n<br/>\nПервый конгресс, пожалуй, был единственным, на котором осуществлялся синхронный перевод — было четыре рабочих языка: английский, русский, немецкий и французский. Для обеспечения конгресса готовилась специальная группа переводчиков. Любопытно отметить, что доклад Р. Калмана «Об общей теории систем управления» [6] на русский язык переводил Анатолий Григорьевич Бутковский, впоследствии ставший выдающимся ученым, основоположником теории управления систем с распределенными параметрами. С 1975 г. он руководит исследовательской лабораторией по этому направлению в Институте проблем управления (ИПУ) РАН. В 1996 г. на 13-м конгрессе ИФАК в США в докладе «История управления с 1960 года», имя А.Г. Бутковского включено в число пяти имен выдающихся ученых России, внесших в теорию управления самый большой вклад [80]. Заметим, что сотрудники ИПУ РАН, возглавляемого в то время академиком В.А. Трапезниковым, внесли значительный вклад в организацию и проведение первого конгресса ИФАК [80].<br/>\n<br/>\nВ период проведения конгресса также были организованы лекции в Политехническом музее с переводом на русский язык. Лекции проводились в такой последовательности: С. Левшец, Р. Калман; Н.Винер. Как вспоминает Калман, для него было весьма почетным оказаться в «сэндвиче» со столь известными учеными, которых он считал своими учителями.<br/>\n<br/>\nЗаметим, что участниками первого конгресса были и три члена Академии навигации и управления движением: Анатолий Ефимович Сазонов, Георгий Николаевич Лебедев и Ефим Натанович Розенвассер. Причем Е.Н. Розенвассер делал на этом конгрессе доклад, и ему довелось достаточно часто общаться с Р. Калманом, поскольку их номера в гостинице находились рядом. Здесь представлена достаточно уникальная фотография участников конгресса.<br/>\n<br/>\nЛюбопытна история этой фотографии. Будучи участником 16-го конгресса ИФАК в Праге в 2005 г., я мельком видел ее у Ефима Натановича, который привез ее для того, чтобы показать Р. Калману.<br/>\n<br/>\nПри подготовке к докладу я попросил это фото у Ефима Натановича, на что он мне с сожалением ответил, что фотография затерялась, но у него ее брали организаторы конгресса в Праге, для того чтобы снять копию. Я обратился к члену национального комитета 16-го конгресса, известному ученому из Чехии, М. Симандлу (M. Simadle), с просьбой прислать копию этой фотографии или каких-либо других фотографий с первого конгресса, где, возможно, присутствует Р.Калман. Достаточно оперативно мне были любезно присланы три фотографии, в том числе и та, о которой идет речь, но при этом отмечалось, что фото с Калманом, к сожалению, отсутствует. Впоследствии все-таки Р. Калман на этой фотографии был найден (второй слева во втором ряду) и от него получено подтверждение о том, что это именно он.<br/>\n<br/>\n<br/>\nУчастники конгресса, Москва 1960. (фото получено из секретариата ИФАК в 2010 г.)<br/>\n<br/>\nЗавершая раздел о связи Р. Калмана с нашей страной, замечу следующее. Для людей моего и более старшего поколений известные ученые из-за рубежа были скорее некими символами, а их результаты воспринимались как нечто существующее само по себе. В значительной степени это объяснялось ограниченными возможностями непосредственного общения с зарубежными коллегами. За последние годы ситуация коренным образом изменилась. Толчком к тому, чтобы реально осознать, что Рудольф Калман — наш современник, для меня послужила его статья, опубликованная в журнале «Авиакосмическое приборостроение» (главный редактор Г.Н.Лебедев) в 2004 г. [10]. И даже не сама статья, а тот факт, что перевод и редактирование ее были выполнены коллегой по АНУД профессором Московского авиационного университета К.К.Веремеенко, который, как оказалось, активно общался по электронной почте с профессором Р.Калманом, выполняя этот перевод. А уже в 2005 г. в Праге удалось самому пообщаться и даже получить автограф на упомянутом журнале. Окончательное превращение Р. Калмана из некоей легендарной, абстрактной личности в реального ученого произошло в период последнего на сегодняшний день его пребывания в России.<br/>\n<br/>\n<br/>\nПосле получения автографа. Прага, 2005 г.<br/>\n<br/>\nЭтот визит состоялся в июне 2006 г. благодаря усилиям академика А.Б.Куржанского. В Москве Р. Калмана принимал вице-президент Академии наук Н. Платэ. Р. Калман посетил «Звездный городок» и выступил с лекцией в Московском государственном университете, а также побывал в Математическом институте им. В.М. Стеклова.<br/>\n<br/>\n<br/>\nР. Калман и академик РАН В.Г. Пешехонов на лекции в Доме ученых. С.-Петербург, 2006 г.<br/>\n<br/>\nВ Санкт-Петербурге Р.Калман встречался в Доме ученых с Президентом АНУД, председателем Санкт-Петербургской группы национального комитета по автоматическому управлению, академиком РАН В.Г.Пешехоновым, а потом состоялась памятная для многих ученых нашего города лекция под названием «Центральная проблема в теории систем: история, прогресс и надежды» [71].<br/>\n<br/>\n<h3>Заключение</h3><br/>\nВ период вручения Р. Калману премии Киото в 1985 г., он, общаясь с прессой, привел такое высказывание, которое впервые увидел в одном из пабов в Колорадо Спрингс [14]: «Маленькие (little) люди обсуждают других людей, средние (medium) люди обсуждают события, а большие (big) люди обсуждают идеи». Не знаю точно, в каком контексте произносилась эта фраза и какой смысл вкладывал сам Р. Калман в слово big, но, думаю, что те, кто знаком с его трудами, не сомневаются, в том, что применительно к Р. Калману, это слово следует перевести, как «выдающийся».<br/>\n<br/>\n<h3>Благодарности</h3><br/>\nАвтор выражает свою признательность всем, кто в той или иной степени помогал в формировании и подготовке материалов к настоящей статье, в том числе: В.М. Зиненко (ГНЦ РФ ОАО «Концерн «ЦНИИ «Электроприбор», С.-Петербург), М.В. Пятницкой (ИПУ РАН, Москва), Е.Н. Розенвассеру (Санкт-Петербургский государственный морской технический университет), А.Е. Сазонову (Государственная морская академия им. адм. С.О.Макарова, С.-Петербург), Ю.А. Соловьеву (ФГУ «30 ЦНИИ Минобороны России», Москва), Н.Б. Филимонову (Институт машиноведения им. А.А.Благонравова РАН, Москва), А.Л. Фрадкову (Институт проблем машиноведения РАН, С.-Петербург), М.С. Ярлыкову (Военно-воздушная академия им. проф. Н.Е.Жуковского и Ю.А.Гагарина, Москва), Л. Камберлену (Франция).<br/>\n<br/>\n<h3>Последние годы</h3><br/>\nНесмотря на преклонный возраст, Р. Калман не переставал заниматься научной и просветительской деятельностью. Год назад он посетил Санкт-Петербург, где выступил с открытым докладом «Insight from the Outside» на конференции IFAC «Modelling, Identification and Control of Nonlinear Systems». Среди слушателей было немало сотрудников, студентов и аспирантов кафедры ИНС Университета ИТМО. Р. Калман любезно согласился подписать общую фотографию и пожелал творческих успехов молодым ученым.<br/>\n<br/>\n<br/>\nР. Калман с сотрудниками, студентами и аспирантами кафедры ИНС.<br/>\n<br/>\nОт себя осталось только добавить слова благодарности Р. Калману. Уверен, что идеи, предложенные им, найдут еще немало замечательных приложений и станут основой для новых изобретений.<br/>\n<br/>\n<b class=\"spoiler_title\">Литература</b>1. Autolas A.S., ed., Mathematical System Theory, The Influence of R.E.Kalman, Springer-Verlag, Berlin, 1991.<br/>\n2. Basar T. (Ed.) Contol theory. Twenty five seminal papers (1932-1982). IEEE.<br/>\n3. Kalman, R. E., A New Approach to Linear Filtering and Prediction Problems Trans. ASME (American Society of Mechanical Engineers), J. Basic Eng., 1960, vol. 82 D.<br/>\n4. Kalman, R. E., Contributions to the Theory of Optimal Control. Bol. Soc. Mat. Mexicana, 5, 102-119, 1960.<br/>\n5. Kalman, R. E., Mathematical Description of Linear Dynamical Systems // SIAM J. Control., vol. 1, 1963, pp. 152-192. <br/>\n6. Калман Р. Об общей теории систем управления // Труды 1-го конгресса ИФАК. М: Из-во АНСССР. 1961г., Т.2 .521-547. (On the general theory of control systems, in Proceeding first IFAC <br/>\nCongress on Automatic Control, Moscow, 1960; Butterworths, London, 1961, Vol. 1, pp.481-492.<br/>\n7. Kalman, R. E., Bucy R. S., New Results in Linear Filtering and Prediction Theory, Transactions of the ASME — Journal of Basic Engineering, Vol. 83: pp. 95-107 (1961). Калман Р.Е., Бьюси Р.С. Новые результаты в теории линейной фильтрации и предсказания // Теоретические основы инженерных <br/>\nрасчетов .- 1961.- N 1.- Сер. Д.Р. Калман и академик РАН В.Г. Пешехонов на лекции в Доме ученых. С.-Петербург, 2006 г.Фильтр Калмана: история и современность № 2 (69), 2010 119<br/>\n8. Калман Р., П.Фалб Арбиб/ Очерки по математической теории систем. М.: Мир, 1971. <br/>\n9. Калман Р. Е. Идентификация систем с шумами // УМН, 1985, том 40:4(244), 27–41. Калман Р. Ньютонианская революция в технологии систем. Открытие или изобретение. Авиакосмическое приборостроение. 6, 2004. Швейцарский национальный институт технологии Цюрих. Оригинал статьи опубликован в Journal of Guidance, Dynamics, and Control (ноябрь-декабрь, 2003).<br/>\n11. Калман Р. Когда линейная система является оптимальной? 1964. Теоретические основы инженерных расчетов (ТОИР) N1 серия Д. Перевод Труды американского общества инженеров механиков. Kalman P. When is a linear control system optimal Trans ASME (J.Basic Engineering). 86D (1964). Pp54-60. Article reprinted in Frequency Response Methods, edited by A.J.C. MacFarlane, IEEE Pres.<br/>\n12. Курдюков А.П. От теории LQG к минимаксной фильтрации и управлению: Доклад на семинаре ИПУ РАН 1.04.2010 Современные методы навигации и управления, посвященном 80-летию Рудольфа Эмиля Калмана // Автоматика и телемеханика, 2010, N11.<br/>\n13. Рубинович Е.Я. 50 лет фильтру Калмана. Современные методы навигации и управления: Доклад на семинаре ИПУ РАН 1.04.2010 Современные методы навигации и управления, посвященном 80-летию Рудольфа Эмиля Калмана // Автоматика и телемеханика, 2010, N11.<br/>\n14. Grewal M., A.P. Andrews. Kalman Filtering. Theory and Practice. Prentice Hall, Information and System Sciences Series. T. Kailath, Series Editor, 1993 г. <br/>\n15. Синицын И.Н. Фильтры Калмана Пугачева. – М.: Логос 2006.<br/>\n16. Синицын И.Н., Степанов О.А. Рудольф Калман в России. Наукоемкие технологии, 2007, N8, с.92-106.<br/>\n17. Sorenson H. W. Least Square Estimation from Gauss to Kalman // IEEE spectrum. Vol.7, July, P. 63-68, 1970.<br/>\n18. Lainiotis D.G. Estimation: brief survey. Information Sciences. Vol. 7, pp. 191-202, 1974.<br/>\n19. Kailath T. A View of Three Decades of Linear Filtering Theory. IEEE Trans.Information Theory. 1974, Vol. IT-20, 146-181.<br/>\n20. Schmidt S.F., Kalman Filter: its Recognition and Development for Aerospace Applications // AIAAA Journal of Guidance and Control, Vol.4,pp.4-7,1981.<br/>\n21. R.H.Battin. Space Guidance Evolution-a personal narrative // AIAA Journal of Guidance and Control, Vol. 5, pp. 97-110, 1982.<br/>\n22. Kailath T. From Kalman Filtering to Innovations, Martingales, Scattering and Other Nice Things. In Autolas A.S., ed., Mathematical System Theory, The Influence of R.E.Kalman, Springer-Verlag, Berlin, 1991.<br/>\n23. Anderson B.D.O., Anderson, J.B. Morre, Kalman Filtering: Whence, What, and Whither? In Autolas A.S., ed., Mathematical System Theory, The Influence of R.E.Kalman, Springer-Verlag, Berlin, 1991.<br/>\n24. Тихонов В.И. Развитие в СССР теории оптимальной фильтрации сообщений//Радиотехника. — 1983. — N 11.<br/>\n25. Тихонов В.И. Развитие прикладных методов оптимальной фильтрации //Радиотехника. — 1996. — N 7. Журнал в журнале. Статистический синтез радиосистем. — N 1. — С. 55-58.<br/>\n26. Тихонов В.И. Развитие в России оптимального нелинейного оценивания случайных процессов и полей // Радиотехника, 1999, N10, с.4-20.<br/>\n27. Шахтарин Б.И. Фильтры Винера и Калмана. Гелиос. АРВ. Москва 2008.<br/>\n28. Kolmogoroff A., Sur l’interpolation et extrapolation des suites stationnaires, Copmtes Rundus de l’Acad. Sci., Paris, 208, 1939, 2043-2045.<br/>\n29. Колмогоров А.Н. Интерполирование и экстраполирование случайных последовательностей //Известия АНСССР. Сер. Матем. Том.5, 1, с.3-14. 1941.<br/>\n30. Wiener N. Extrapolation, interpolation and smoothing of stationary time series, with engineering applications. John Wiley, New York, 1949 (Originally issued in February 1942, as a classified Nat. Defense Res. Council Rep.).<br/>\n31. Профессор Р.Л.Стратонович (1930-1967). Воспоминания родных коллег и друзей. Под редакцией Ю.М. Романовского. Институт компьютерных исследований. Москва Ижевск 2007.<br/>\n32. Соловьев Ю.А., Ярлыков М.С. 80 лет со дня рождения Р.Л.Стратоновича // Автоматика и телемеханика, 2010, N 7, c. 185-188.<br/>\n33. Ярлыков М.С., М.А.Миронов. Марковская теория оценивания случайных процессов. М.: Радио и связь. 1993, 461 с.<br/>\n34. Стратонович Р.Л. К теории оптимальной нелинейной фильтрации случайных функций // Теория вероятностей и ее применение. 1959. Т.4, вып. 2. 239-242. <br/>\n35. Стратонович Р.Л. Оптимальные нелинейные системы, осуществляющие выделение сигнала с постоянными параметрами из шума // Изв. вузов СССР. Сер. Радиофизика. 1959. Т.2., с. 862-901.<br/>\n36. Стратонович Р.Л. Условные марковские процессы и их применение к теории оптимального управления. — М.: изд-во МГУ, 1966. — 319 с.<br/>\n37. Jazwinski A.H. Stochastic processes and filtering theory. — New York. Academic Pres, 1970.<br/>\n38. Gelb A., J.Kasper, R.A.Nash, C.Price, A. Satherland. Applied optimal estimation // M.I.T. Press, Cambridge, MA,1974.<br/>\n39. K. J. Astrom. Adaptive control. In Autolas A.S., ed., Mathematical System Theory, The Influence of R.E.Kalman, Springer-Verlag, Berlin, 1991.<br/>\n40. Busy R.S., Senne K.D. Digital synthesis of nonlinear filters// Automatica. — 1971. Vol.7, N 3. — P. 287-298.<br/>\n41. Alspach D.L., Sorenson H.W. Nonlinear Bayesian estimation using Gaussian sum approximations//IEEE Trans.Aerospace.and Electronic Syst.-1972.- Vol.AC-17,N 4.-P.439-448.<br/>\n42. Логинов В.П. Приближенные алгоритмы нелинейной фильтрации // Зарубежная радиоэлектроника. — 1975. — N 2, Ч. 1. — С.28-48; 1976. — N 3, Ч. 2. — С.3-28.<br/>\n43. Степанов О.А. Применение теории нелинейной фильтрации в задачах обработки навигационной информации. СПб.: ГНЦ ЦНИИ Электроприбор 1998.<br/>\n44. Bergman N. Recursive Bayesian Estimation. Navigation and Tracking Applications. PhD. Dissertations No.579 1999. Department of Electrical Engineering Linkoping University, SE-581-83 Linkoping, Sweden.<br/>\n45. Липцер Р.Ш., Ширяев А.Н. Статистика случайных процессов. М.: Наука, 1974.<br/>\n46. Пугачев В.С. Стохастические дифференциальные системы. 1985.<br/>\n47. Фомин В.Н. Рекуррентное оценивание и адаптивная фильтрация. М.: Наука, 1984.<br/>\n48. Куржанский А.Б. Управление и наблюдение в условиях неопределенности. -М.: Наука, 1977.<br/>\n49. Розов А.К. Нелинейная фильтрация сигналов // Политехника, 2002, с. 372.<br/>\n50. P. Faurre. Kalman Filtring and the Advancenment of Navigation and Guidance. In Autolas A.S., ed., Mathematical System Theory, The Influence of R.E.Kalman, Springer-Verlag, Berlin, 1991.<br/>\n51. Кpасовский А.А., Белоглазов И.Н., Чигин Г.П. Теория коppеляционно-экстpемальных навигационных систем. М.: Наука, 1979. — 448 с.<br/>\n52. Челпанов И.Б. Оптимальная обработка сигналов в навигационных системах. М.: Наука, 1967.<br/>\n53. Богуславский И.А. Методы навигации и управления по неполной статистической информации. <br/>\nМ.: Машиностроение, 1970. – 253 с.<br/>\n54. Ривкин С.С. Метод оптимальной фильтрации Калмана и его применение в инерциальных навигационных системах. Ч. 1, 2. — Л.: Судостроение, 1973.1974.<br/>\n55. Ривкин С.С., Ивановский Р.И., Костров А.В. Статистическая оптимизация навигационных систем. — Л.: Судостроение, 1976.<br/>\n56. Кузовков Н.Т., Салычев О.С. Инерциальная навигация и оптимальная фильтрация. М.: Машиностроение, 1982. — 216 с.<br/>\n57. Дмитpиев С.П. Высокоточная морская навигация. Л.: Судостpоение, 1991.- 222 с.<br/>\n58. Бабич О.А. Обработка информации в навигационных комплексах. — М.: Машиностроение, 1991.<br/>\n59. Степанов О.А. Основы теории оценивания с приложениями к задачам обработки навигационной <br/>\nинформации. Часть1. Введение в теорию оценивания. СПб.: ЦНИИ Электроприбор. 2009.<br/>\n60. Daum, F. (2005). Nonlinear Filters: Beyond the Kalman Filter // IEEE Aerospace and Electronic Systems. Tutorials, Vol. 20(8), pp. 57-71.<br/>\n61. Juiler, S. J. and J. K. Uhlmann. Unscented Filtering and Nonlinear Estimation//Proc. IEEE, Vol. 92(3), 2004, pp. 401-422. <br/>\n62. Lefebvre, T., H. Bruyninckx and J. De Schutter. Nonlinear Kalman Filtering for Force-Controlled Robot Tasks. Springer, Berlin, 2005.<br/>\n63. Li, X. R. and V.P. Jilkov. A survey of Maneuvering Target Tracking: Approximation Techniques for Nonlinear Filtering. Proc. 2004 SPIE Conference on Signal and Data Processing of Small Targets, San Diego, pp 537-535, 2004.<br/>\n64. Van der Merwe, R. and E. A. Wan. The Unscented Kalman Filter. In: Kalman Filtering and Neural Networks (Haykin S.), pp. 221-268, John Wiley & Sons. Inc., 2001.<br/>\n65. Doucet, A., de Freitas, N. and Gordon, N.J. Sequential Monte Carlo Methods in Practice. Springer Verlag, New York, 2001, p.581.<br/>\n66. Branko Ristic, Sanjeev Arulampalam, Neil Gordon, Beyond the Kalman Filter: Particle Filter for Tracking Applications. Artech House Radar Library. 2004.<br/>\n67. Зарицкий В.С., Светник В.Б., Шимелевич Л.И. Метод Монте-Карло в задачах оптимальной обработки информации // Автоматика и телемеханика, 1975, N12, 95-103.<br/>\n68. Памяти профессора Несенюка Л.П. Избранные труды и воспоминания. СПб. ГНЦ РФ ОАО Концерн Электроприбор, 2010.<br/>\n69. Калман Р. Распознавание образов полилинейными машинами, in Proc. IFAC Conference on Adaptive Systems. Ереван, СССР, Сентябрь 1968, с.7-30. М.: Наука, 1971.<br/>\n70. Kalman P. New algebraic methods in stability theory. Proc. 5th International Congress on Nonlinear Oscillations, Kiev, 1969. Опубликовано в издании Института математики академии наук СССР, Киев, 1970, Vol.2, pp.189-199.<br/>\n71. Степанов О.А. Р. Калман В Санкт-Петербург. Гироскопия и навигация. 2006, N3, с.117-121.<br/>\n72. Понтрягин Л.С. Жизнеописание, математика, написанное им самим. Издательство <br/>\nКомкнига 2006.<br/>\n73. Яков Залманович Цыпкин (1919-1997). Отв. Редактор Поляк Б.Т. М. Издательство ЛКИ, 2007. 304с. Фильтр Калмана: история и современность № 2 (69), 2010 121<br/>\n74. Якубович В.А. «Решение некоторых матричных неравенств, встречающихся теории автоматического регулирования (1962. ДАН СССР Т.143, N6, 1304-1307).<br/>\n75. Гусев С.В., А.Л. Лихтарников. «Очерк истории леммы Калмана-Попова-Якубовича и S-процедуры» Автоматика и телемеханика 2006, N11, с. 77-121.<br/>\n76. Kalman R. Lyapunov Functions for the problem of Lure’ in Automatic Control. Proc. NAS US 1963 v.49, pp.201-205.<br/>\n77. Труды 1-го конгресса ИФАК. М: Из-во АНСССР. 1961г., Т.1- Т6.<br/>\n78. B. Widrow. Recollections of Norbert Wiener and the First IFAC World Congress. By Bernard Widrow (as told to Barbara Field) IEEE Control Systems Magazine. June, 2001г. 65-70.<br/>\n79. Б.Уидроу, С. Стирнз. Адаптивная обработка сигналов. Москва. Радио и связь, 1989 г.<br/>\n80. Институт управления им. В.А. Трапезникова – 70 лет. Под редакцией С.Н.Васильева. 2009г… 580-с.<br/>
    """

    print(process_article(html_content=sample))
